import resolve from 'rollup-plugin-node-resolve';
import eslint from 'rollup-plugin-eslint';
import babel from 'rollup-plugin-babel';
import commonjs from 'rollup-plugin-commonjs';
import { terser } from "rollup-plugin-terser";

// `npm run build` -> `production` is true
// `npm run dev` -> `production` is false
const production = !process.env.ROLLUP_WATCH;
const file = `dist/cells-semaas-adapter${production ? '.min' : ''}.js`;

export default {
  input: 'src/semaas.js',
  output: {
    name: 'SEMaaS',
    file,
    format: 'umd', // Universal Module Definition, works as amd, cjs and iife all in one
    sourcemap: true
	},
  plugins: [
    eslint({}),
    babel({
      plugins: ['external-helpers']
    }),
    resolve(), // tells Rollup how to find date-fns in node_modules
    commonjs(), // converts date-fns to ES modules
    production && terser() // minify, but only in production
  ]
};
